name: Release course material to GitHub Releases

on:
  push:
    tags:
      - '*'

# Sets permissions of the GITHUB_TOKEN to allow release to GitHub Releases
permissions:
  contents: write

jobs:
  build-and-release-course-material:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Build theoretical content with Marp
        uses: docker://marpteam/marp-cli:v3.0.2
        with:
          entrypoint: sh
          args: build-theoretical-content.sh

      - name: Build practical content with Pandoc
        uses: docker://pandoc/latex:2.9
        with:
          entrypoint: sh
          args: build-practical-content.sh

      - name: Release course material to GitHub Releases
        uses: softprops/action-gh-release@v1
        with:
          body: |
            This release contains the course material for the DAI course at [HEIG-VD](https://heig-vd.ch), Switzerland.
          files: |
            **/*.pdf
